{
  "uid" : "8dfca13e9a8fcfd3",
  "name" : "人物搜索",
  "fullName" : "api_test.testcase.test_person.test_person.TestPerson#test_person_search",
  "historyId" : "4d9f5e36fa4a502618484bbeb2c3eac3",
  "time" : {
    "start" : 1683604329083,
    "stop" : 1683604332330,
    "duration" : 3247
  },
  "status" : "failed",
  "statusMessage" : "AssertionError: assert 'https://i9.t...q9WGCxbd-a160' == ''\n  + https://i9.taou.com/maimai/p/6102/3405_101_e25lT1q9WGCxbd-a160",
  "statusTrace" : "self = <api_test.testcase.test_person.test_person.TestPerson object at 0x00000243713C6A48>\ntest_data = {'cnt': 16, 'company_member_list': [{'company_id': 6752841715938266009, 'created_at': datetime.datetime(2023, 4, 26, 1...4, 26, 13, 44, 37), 'end_time': '2016-06-01', 'id': 39809816, ...}], 'data_id': 1778856376659541981, 'edu_cnt': 1, ...}\n\n    @allure.title('人物搜索')\n    @pytest.mark.parametrize('test_data', person_yaml_data)\n    def test_person_search(self, test_data):\n        result = p.person_search_v3(test_data['name'],'')\n        result_info = result['data']['items']\n        person_id = str(test_data['data_id'])\n        # 断言搜索结果与数据库保持一致\n        sql_person_cnt = f'select count(*) count from person where name like \"%{test_data[\"name\"]}%\" and `from` <> \"脉脉\" and data_id  in (select person_id from company_member)'\n        cnt = s.get_one_value(sql_person_cnt)\n        assert cnt == result['data']['cnt']\n        #断言人名与搜索相同或包\n        #断言搜索结果页人物按照公司规模倒叙\n        # if test_data['result_num_order']:\n        #     assert str(test_data['result_num_order']['company_id']) == result['data']['items'][0]['company_id']\n        # else:\n        #     print('只搜到1条人物数据，无需排序')\n        # 断言头像,有头像展示头像,无头像展示简称\n        person_detail = p.person_detail_v2(str(test_data['data_id']))\n        if test_data['person_list']:\n            if test_data['person_list']['avatar'] == '' or test_data['person_list']['avatar'] == '-':\n>               assert person_detail['data']['basic']['logo'] == ''\nE               AssertionError: assert 'https://i9.t...q9WGCxbd-a160' == ''\nE                 + https://i9.taou.com/maimai/p/6102/3405_101_e25lT1q9WGCxbd-a160\n\napi_test\\testcase\\test_person\\test_person.py:102: AssertionError",
  "flaky" : false,
  "newFailed" : false,
  "beforeStages" : [ ],
  "afterStages" : [ ],
  "labels" : [ {
    "name" : "feature",
    "value" : "人物测试案例"
  }, {
    "name" : "parentSuite",
    "value" : "api_test.testcase.test_person"
  }, {
    "name" : "suite",
    "value" : "test_person"
  }, {
    "name" : "subSuite",
    "value" : "TestPerson"
  }, {
    "name" : "host",
    "value" : "DESKTOP-AR41KHM"
  }, {
    "name" : "thread",
    "value" : "29684-MainThread"
  }, {
    "name" : "framework",
    "value" : "pytest"
  }, {
    "name" : "language",
    "value" : "cpython3"
  }, {
    "name" : "package",
    "value" : "api_test.testcase.test_person.test_person"
  }, {
    "name" : "resultFormat",
    "value" : "allure2"
  } ],
  "parameters" : [ {
    "name" : "test_data",
    "value" : "{'cnt': 16, 'company_member_list': [{'company_id': 6752841715938266009, 'created_at': datetime.datetime(2023, 4, 26, 13, 5, 25), 'end_time': '', 'id': 39693902, 'is_delete': 0, 'job_status': 1, 'major_type': 0, 'organize_type': 0, 'person_from': 2, 'person_id': 1778856376659541981, 'pos_weight': 35, 'position': '商务总监', 'position_label_five': 0, 'position_label_four': 0, 'position_label_one': 0, 'position_label_six': 1, 'position_label_three': 0, 'position_label_two': 0, 'start_time': '2017-03-01', 'updated_at': datetime.datetime(2023, 4, 26, 13, 5, 25), 'useful_position': '28', 'useful_position_json': '[{\"id\": \"28\", \"name\": \"商务总监\"}]'}, {'company_id': 9200532213037885179, 'created_at': datetime.datetime(2023, 4, 26, 13, 44, 37), 'end_time': '2016-06-01', 'id': 39809816, 'is_delete': 0, 'job_status': 2, 'major_type': 0, 'organize_type': 0, 'person_from': 2, 'person_id': 1778856376659541981, 'pos_weight': 40, 'position': '知产顾问商务经理', 'position_label_five': 1, 'position_label_four': 0, 'position_label_one': 0, 'position_label_six': 1, 'position_label_three': 0, 'position_label_two': 0, 'start_time': '2016-06-01', 'updated_at': datetime.datetime(2023, 4, 26, 13, 44, 37), 'useful_position': '30,40', 'useful_position_json': '[{\"id\": \"30\", \"name\": \"商务经理\"}, {\"id\": \"40\", \"name\": \"顾问\"}]'}], 'data_id': 1778856376659541981, 'edu_cnt': 1, 'edu_list': [{'created_at': datetime.datetime(2023, 2, 15, 19, 39, 33), 'degree': '1', 'end_time': '2014-7', 'id': 252434, 'person_id': 1778856376659541981, 'professional': '市场营销', 'school_name': '南京大学网络学院', 'school_url': '', 'start_time': '2012-9', 'updated_at': datetime.datetime(2023, 2, 15, 19, 39, 33)}], 'introduction': '广州市专注鱼信息科技有限公司南京分公司商务总监', 'is_linked': 1, 'member_cnt': 2, 'name': '董志超', 'person_list': {'avatar': '', 'avatar_word': '董', 'created_at': datetime.datetime(2022, 10, 14, 10, 43, 40), 'data_id': 7645098948475000524, 'from': '爱企查', 'id': 311593, 'introduction': '', 'is_delete': 0, 'is_linked': 1, 'name': '董志超', 'tags': '', 'updated_at': datetime.datetime(2022, 10, 14, 10, 43, 40), 'us3_introduction': ''}, 'person_news_cnt': 0, 'result_num_order': {'company_id': 2376733937214998514, 'insuranceNum': 1173}, 'tags': '销售'}"
  } ],
  "links" : [ ],
  "hidden" : true,
  "retry" : true,
  "extra" : {
    "categories" : [ ],
    "tags" : [ ]
  },
  "source" : "8dfca13e9a8fcfd3.json",
  "parameterValues" : [ "{'cnt': 16, 'company_member_list': [{'company_id': 6752841715938266009, 'created_at': datetime.datetime(2023, 4, 26, 13, 5, 25), 'end_time': '', 'id': 39693902, 'is_delete': 0, 'job_status': 1, 'major_type': 0, 'organize_type': 0, 'person_from': 2, 'person_id': 1778856376659541981, 'pos_weight': 35, 'position': '商务总监', 'position_label_five': 0, 'position_label_four': 0, 'position_label_one': 0, 'position_label_six': 1, 'position_label_three': 0, 'position_label_two': 0, 'start_time': '2017-03-01', 'updated_at': datetime.datetime(2023, 4, 26, 13, 5, 25), 'useful_position': '28', 'useful_position_json': '[{\"id\": \"28\", \"name\": \"商务总监\"}]'}, {'company_id': 9200532213037885179, 'created_at': datetime.datetime(2023, 4, 26, 13, 44, 37), 'end_time': '2016-06-01', 'id': 39809816, 'is_delete': 0, 'job_status': 2, 'major_type': 0, 'organize_type': 0, 'person_from': 2, 'person_id': 1778856376659541981, 'pos_weight': 40, 'position': '知产顾问商务经理', 'position_label_five': 1, 'position_label_four': 0, 'position_label_one': 0, 'position_label_six': 1, 'position_label_three': 0, 'position_label_two': 0, 'start_time': '2016-06-01', 'updated_at': datetime.datetime(2023, 4, 26, 13, 44, 37), 'useful_position': '30,40', 'useful_position_json': '[{\"id\": \"30\", \"name\": \"商务经理\"}, {\"id\": \"40\", \"name\": \"顾问\"}]'}], 'data_id': 1778856376659541981, 'edu_cnt': 1, 'edu_list': [{'created_at': datetime.datetime(2023, 2, 15, 19, 39, 33), 'degree': '1', 'end_time': '2014-7', 'id': 252434, 'person_id': 1778856376659541981, 'professional': '市场营销', 'school_name': '南京大学网络学院', 'school_url': '', 'start_time': '2012-9', 'updated_at': datetime.datetime(2023, 2, 15, 19, 39, 33)}], 'introduction': '广州市专注鱼信息科技有限公司南京分公司商务总监', 'is_linked': 1, 'member_cnt': 2, 'name': '董志超', 'person_list': {'avatar': '', 'avatar_word': '董', 'created_at': datetime.datetime(2022, 10, 14, 10, 43, 40), 'data_id': 7645098948475000524, 'from': '爱企查', 'id': 311593, 'introduction': '', 'is_delete': 0, 'is_linked': 1, 'name': '董志超', 'tags': '', 'updated_at': datetime.datetime(2022, 10, 14, 10, 43, 40), 'us3_introduction': ''}, 'person_news_cnt': 0, 'result_num_order': {'company_id': 2376733937214998514, 'insuranceNum': 1173}, 'tags': '销售'}" ]
}